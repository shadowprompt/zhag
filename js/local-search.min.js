/*!
 * Hexo Theme Suka | local-search.js
 * Author: SukkaW
 * Link: https://github.com/SukkaW/hexo-theme-suka
 * License: GPL-3.0
 */
!function(){window.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null==e?"":decodeURIComponent(e[1])};var o=window.getParameterByName("s");window.searchEscape=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return e.replace(/[&<>"'/]/g,function(e){return t[e]})},window.searchFunc=function(e,a){"use strict";fetch(e).then(function(e){return e.json()}).then(function(e){var g,m,w,t=document.getElementById("search-output"),n=document.getElementById("search-result-num"),r=document.getElementById("search-result-info"),v=[];void 0!==o&&(g=o,m=function(){var e,t=g.trim().toLowerCase().split(/[\s\-]+/),n=[];for(e in t){var r=t[e];if(-1<r.indexOf("+")){var a,o=r.split("+");for(a in o)n.push(o[a])}else n.push(r)}return n}(),window.searchKeyword=m,w=0,t.innerHTML="",g.trim().length<=0||(e.forEach(function(e){var n,r,a,o,i,c,s,l,u,t,d,f,p,h;void 0!==e.title&&void 0!==e.content&&(n=!0,r=e.title.trim().toLowerCase(),f=new Date(e.date).toLocaleDateString(),a=void 0!==e.tags?e.tags:[],o=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),l=s=c=i=-1,u=0,""!==r&&""!==o&&m.forEach(function(e,t){i=r.indexOf(e),c=a.indexOf(e),s=o.indexOf(e),i<0&&c<0&&s<0?n=!1:(0<=i&&(u+=4),0<=c&&(u+=2),0<=s&&(u+=1),0===t&&(l=s),w++)}),n&&(t="",t+='<div class="tile"><div class="tile-content">',d=e.title,m.forEach(function(e){var t=new RegExp(e,"gi");d=d.replace(t,"<strong><mark>"+window.searchEscape(e)+"</mark></strong>")}),t=(t+='<a href="'+e.url+'"><p class="tile-title search-result-title">'+d+"</p></a>")+'<p class="text-gray search-result-summary"><span class="saerch-result-date">'+f+"</span>",f=e.content,0<=l&&(e=l+20,(e=0===(p=(p=l-15)<0?0:p)?20:e)>f.length&&(e=f.length-20),h=f.substr(p,e),m.forEach(function(e){e=new RegExp(e,"gi");h=h.replace(e,"<strong><mark>"+window.searchEscape(g)+"</mark></strong>")}),t+=h+"...</p>"),v.push([t+="</div></div>",u])))}),e=function(){var e,t="";for(e in v.sort(function(e,t){return t[1]-e[1]}),v)t+=v[e][0];return t}(),n.appendChild(document.createTextNode(v.length)),w<=0?(r.style.display="none",t.innerHTML=a):(r.style.display="block",t.innerHTML=e)),document.getElementById("search-field").setAttribute("value",o))})}}();